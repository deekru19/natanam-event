"use strict";(self.webpackChunkdance_event_app=self.webpackChunkdance_event_app||[]).push([[275],{275:(e,t,s)=>{s.r(t),s.d(t,{default:()=>i});var r=s(43),n=s(951),a=s(579);const i=e=>{let{selectedSlots:t,performanceType:s,participantDetails:i,onBack:c,onPaymentSuccess:o,onPaymentFailure:l}=e;const[d,m]=(0,r.useState)(!1),[p,u]=(0,r.useState)(""),h=n.J.performanceTypes.find(e=>e.id===s);if(!h)return(0,a.jsx)("div",{children:"Invalid performance type."});const x=(()=>{switch(s){case"solo":default:return 1;case"duet":return 2;case"group":const e=i.participantNames||"";if(e.trim()){const t=e.split(/[,\n]/).filter(e=>e.trim()).length;return Math.max(t,1)}return 3}})(),y=t.length*h.pricePerPerson*x,f=()=>{switch(s){case"solo":return i.fullName||"N/A";case"duet":return i.participant1Name||"N/A";case"group":const e=i.participantNames||"";if(e.trim()){return e.split(/[,\n]/).filter(e=>e.trim())[0]||"N/A"}return"N/A";default:return"N/A"}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("button",{onClick:c,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"\u2190 Back"}),(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:"Payment Summary"})]})}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Performance Details"}),(0,a.jsxs)("div",{className:"space-y-1 text-sm text-gray-600",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Type:"})," ",h.name]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Participant(s):"})," ",(()=>{switch(s){case"solo":return i.fullName||"N/A";case"duet":return`${i.participant1Name||"N/A"} & ${i.participant2Name||"N/A"}`;case"group":const e=i.participantNames||"";if(e.trim()){const t=e.split(/[,\n]/).filter(e=>e.trim());return t.length>0?t.join(", "):"N/A"}return"N/A";default:return"N/A"}})()]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Dance Style:"})," ",i.danceStyle||"N/A"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Time Slots"}),(0,a.jsxs)("div",{className:"space-y-1 text-sm text-gray-600",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Selected:"})," ",t.length," slot",1!==t.length?"s":""]}),(0,a.jsx)("p",{children:(0,a.jsx)("span",{className:"font-medium",children:"Times:"})}),(0,a.jsx)("div",{className:"ml-4",children:t.map((e,t)=>(0,a.jsxs)("p",{className:"text-gray-600",children:["\u2022 ",e]},t))})]})]})]}),(0,a.jsx)("div",{className:"border-t pt-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm text-slate-600",children:[(0,a.jsx)("span",{children:"Price per person:"}),(0,a.jsxs)("span",{children:["\u20b9",h.pricePerPerson]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm text-slate-600",children:[(0,a.jsx)("span",{children:"Number of participants:"}),(0,a.jsx)("span",{children:x})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm text-slate-600",children:[(0,a.jsx)("span",{children:"Number of slots:"}),(0,a.jsx)("span",{children:t.length})]}),(0,a.jsxs)("div",{className:"border-t pt-2 mt-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center text-base font-medium",children:[(0,a.jsx)("span",{children:"Total Amount:"}),(0,a.jsxs)("span",{className:"text-slate-700",children:["\u20b9",y.toLocaleString()]})]}),(0,a.jsxs)("p",{className:"text-xs text-slate-500 mt-1",children:["\u20b9",h.pricePerPerson," \xd7 ",x," person",1!==x?"s":""," \xd7 ",t.length," slot",1!==t.length?"s":""]})]})]})})]}),(0,a.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"font-medium text-yellow-800 mb-2",children:"Payment Instructions"}),(0,a.jsxs)("ul",{className:"text-sm text-yellow-700 space-y-1",children:[(0,a.jsx)("li",{children:"\u2022 Please complete the payment using UPI or any preferred method"}),(0,a.jsxs)("li",{children:["\u2022 Amount to pay: \u20b9",y.toLocaleString()]}),(0,a.jsx)("li",{children:"\u2022 You can optionally upload a screenshot of your payment proof"}),(0,a.jsx)("li",{children:"\u2022 Your booking will be confirmed after payment verification"})]})]}),p&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,a.jsx)("p",{className:"text-sm text-red-600",children:p})}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)("button",{onClick:async()=>{m(!0),u("");try{var e;if(!await new Promise(e=>{const t=document.createElement("script");t.src="https://checkout.razorpay.com/v1/checkout.js",t.onload=()=>e(!0),t.onerror=()=>e(!1),document.body.appendChild(t)}))throw new Error("Failed to load Razorpay. Please check your internet connection.");const{phone:r,email:n}={phone:i.phoneNumber||i.participant1Phone||i.representativePhone||"",email:i.email||""},a="test-fe3f0";if(!a)throw new Error("Firebase Project ID not configured. Please check environment variables.");const c=`https://us-central1-${a}.cloudfunctions.net/createRazorpayOrder`;console.log("\ud83c\udf10 Creating order via Firebase Function:",c);const d=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:100*y,currency:"INR",notes:{performance_type:s,time_slots:t.join(", "),participant_count:x.toString()}})});if(!d.ok){const e=await d.text();throw new Error(`Order creation failed: ${d.status} - ${e}`)}const p=await d.json(),u=null===p||void 0===p||null===(e=p.order)||void 0===e?void 0:e.id;if(!u)throw new Error("Order created but no order ID returned from backend");console.log("\u2705 Order created successfully:",u);const j={key:"rzp_test_kqMZu5Fx9pDa9x",amount:100*y,currency:"INR",name:"Natanam Dance Event",description:`${h.name} Performance Registration`,image:"/logo192.png",order_id:u,handler:function(e){console.log("\ud83c\udf89 Payment Success:",e),o({paymentId:e.razorpay_payment_id,orderId:e.razorpay_order_id,signature:e.razorpay_signature,amount:y,currency:"INR"})},prefill:{name:f(),email:n,contact:r},notes:{performance_type:s,time_slots:t.join(", "),participant_count:x.toString()},theme:{color:"#2563eb"},modal:{ondismiss:function(){m(!1)}}},g=new window.Razorpay(j);g.on("payment.failed",function(e){console.log("\u274c Payment Failed:",e),l({error:e.error,reason:e.error.reason,description:e.error.description})}),g.open(),m(!1)}catch(r){console.error("\ud83d\udca5 Payment initialization failed:",r),u(r.message||"Failed to initialize payment. Please try again."),m(!1)}},disabled:d,className:`\n            px-8 py-3 rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed\n            ${d?"bg-gray-400 text-white cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"}\n          `,children:d?"Processing...":`Pay \u20b9${y.toLocaleString()}`})})]})}}}]);
//# sourceMappingURL=275.2377c34c.chunk.js.map