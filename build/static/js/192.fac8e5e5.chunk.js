"use strict";(self.webpackChunkdance_event_app=self.webpackChunkdance_event_app||[]).push([[192],{192:(e,t,a)=>{a.r(t),a.d(t,{default:()=>d});var r=a(43),s=a(203),l=a(951),n=a(579);const d=()=>{const[e,t]=(0,r.useState)(!1),[a,d]=(0,r.useState)([]),[i,o]=(0,r.useState)(null),[c,x]=(0,r.useState)(!1);(0,r.useEffect)(()=>{const e=document.createElement("style");e.textContent="\n      .resizable-table {\n        border-collapse: separate;\n        border-spacing: 0;\n        width: 100%;\n      }\n      .resizable-table th {\n        position: relative;\n        user-select: none;\n        border-right: 1px solid #e2e8f0;\n      }\n      .resizable-table th .resize-handle {\n        position: absolute;\n        top: 0;\n        right: 0;\n        width: 5px;\n        height: 100%;\n        cursor: col-resize;\n        background: transparent;\n        z-index: 1;\n      }\n      .resizable-table th .resize-handle:hover {\n        background: rgba(59, 130, 246, 0.4);\n      }\n      .resizable-table th.resizing {\n        user-select: none;\n      }\n    ",document.head.appendChild(e);return setTimeout(()=>{const e=document.querySelector(".resizable-table");if(!e)return;const t=e.querySelectorAll("th");t.forEach((e,a)=>{if(a===t.length-1)return;const r=e.querySelector(".resize-handle");r&&r.remove();const s=document.createElement("div");s.className="resize-handle",e.appendChild(s);let l=!1,n=0,d=0;s.addEventListener("mousedown",t=>{l=!0,n=t.clientX,d=e.offsetWidth,e.classList.add("resizing"),document.body.style.cursor="col-resize",t.preventDefault()}),document.addEventListener("mousemove",t=>{if(!l)return;const a=t.clientX-n,r=Math.max(100,d+a);e.style.width=r+"px",e.style.minWidth=r+"px"}),document.addEventListener("mouseup",()=>{l&&(l=!1,e.classList.remove("resizing"),document.body.style.cursor="default")})})},100),()=>{document.head.removeChild(e)}},[a]);const[m,p]=(0,r.useState)({}),[u,h]=(0,r.useState)([]),[b,g]=(0,r.useState)([]);(0,r.useEffect)(()=>{y()},[]);const y=async()=>{t(!0);try{const e=await(0,s.Xp)();d(e)}catch(e){console.error("Failed to fetch bookings:",e),alert("Failed to fetch bookings. Please try again.")}finally{t(!1)}},f=async e=>{try{console.log("Loading available time slots for date:",e);const t=await(0,s.oZ)(e);console.log("Available slots:",t),h(t)}catch(t){console.error("Failed to load available time slots:",t),h([])}},j=async(e,t)=>{try{const a=await(0,s.oZ)(e);a.includes(t)||a.push(t),g(a.sort())}catch(a){console.error("Failed to load available time slots for editing:",a),g([t])}},v=e=>{if(!e)return"N/A";try{return new Date(e.toDate()).toLocaleString("en-IN",{timeZone:"Asia/Kolkata",year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})}catch{return"N/A"}};return(0,n.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-8 relative z-10",children:(0,n.jsxs)("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl shadow-xl p-8 border border-slate-200",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-slate-800",children:"Admin Panel - Booking Management"}),(0,n.jsxs)("div",{className:"flex space-x-3",children:[(0,n.jsx)("button",{onClick:async()=>{x(!0);const e=l.J.eventDate;p({...m,date:e}),await f(e)},className:"px-4 py-2 bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-lg hover:from-emerald-600 hover:to-teal-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:"Add Booking"}),(0,n.jsx)("button",{onClick:async()=>{t(!0);try{const e=await(0,s.Y8)();if(e){const t=`dance_event_bookings_${(new Date).toISOString().split("T")[0]}.csv`;(0,s.Bf)(e,t)}else alert("No bookings found to export.")}catch(e){console.error("Export failed:",e),alert("Export failed. Please try again.")}finally{t(!1)}},disabled:e,className:"px-4 py-2 bg-gradient-to-r from-blue-500 to-indigo-500 text-white rounded-lg hover:from-blue-600 hover:to-indigo-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1 disabled:opacity-50",children:e?"Exporting...":"Export CSV"})]})]}),e?(0,n.jsx)("div",{className:"flex justify-center items-center p-12",children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:"w-12 h-12 border-4 border-purple-400/30 border-t-purple-400 rounded-full animate-spin"}),(0,n.jsx)("div",{className:"absolute inset-0 w-12 h-12 border-4 border-transparent border-t-pink-400 rounded-full animate-spin animation-delay-150"})]})}):(0,n.jsxs)("div",{className:"overflow-x-auto",children:[(0,n.jsxs)("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:["All Bookings (",a.length," records)"]}),(0,n.jsxs)("table",{className:"min-w-full bg-white/80 backdrop-blur-sm border border-slate-200 rounded-lg overflow-hidden resizable-table",style:{tableLayout:"fixed"},children:[(0,n.jsx)("thead",{className:"bg-gradient-to-r from-blue-100 to-indigo-200 text-gray-800",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium uppercase tracking-wider",style:{width:"100px",minWidth:"100px"},children:"Actions"}),(0,n.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium uppercase tracking-wider",style:{width:"160px",minWidth:"160px"},children:"Time"}),(0,n.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium uppercase tracking-wider",style:{width:"90px",minWidth:"90px"},children:"Type"}),(0,n.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium uppercase tracking-wider",style:{width:"110px",minWidth:"110px"},children:"Price/Person"}),(0,n.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium uppercase tracking-wider",style:{width:"180px",minWidth:"180px"},children:"Participant Name"}),(0,n.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium uppercase tracking-wider",style:{width:"140px",minWidth:"140px"},children:"Phone"}),(0,n.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium uppercase tracking-wider",style:{width:"220px",minWidth:"220px"},children:"Email"}),(0,n.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium uppercase tracking-wider",style:{width:"120px",minWidth:"120px"},children:"City"}),(0,n.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium uppercase tracking-wider",style:{width:"150px",minWidth:"150px"},children:"Guru Name"}),(0,n.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium uppercase tracking-wider",style:{width:"120px",minWidth:"120px"},children:"Category"}),(0,n.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium uppercase tracking-wider",style:{width:"120px",minWidth:"120px"},children:"Amount/Slot"}),(0,n.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium uppercase tracking-wider",style:{width:"160px",minWidth:"160px"},children:"Timestamp"}),(0,n.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium uppercase tracking-wider",style:{width:"180px",minWidth:"180px"},children:"Payment ID"}),(0,n.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium uppercase tracking-wider",style:{width:"120px",minWidth:"120px"},children:"Status"}),(0,n.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium uppercase tracking-wider",style:{width:"140px",minWidth:"140px"},children:"Booking ID"})]})}),(0,n.jsx)("tbody",{className:"divide-y divide-slate-200",children:a.map((e,t)=>(0,n.jsxs)("tr",{className:"hover:bg-slate-50 transition-colors",children:[(0,n.jsx)("td",{className:"px-4 py-2 text-sm border-b border-slate-200",children:(0,n.jsxs)("div",{className:"flex space-x-1",children:[(0,n.jsx)("button",{onClick:async()=>{o(e),await j(e.date,e.timeSlot)},className:"px-2 py-1 bg-gradient-to-r from-blue-500 to-indigo-500 text-white text-xs rounded hover:from-blue-600 hover:to-indigo-600 transition-all duration-300 shadow-sm",children:"Edit"}),(0,n.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this booking?"))try{await(0,s.VA)(e),await y(),alert("Booking deleted successfully")}catch(t){console.error("Delete failed:",t),alert("Failed to delete booking. Please try again.")}})(e.id),className:"px-2 py-1 bg-gradient-to-r from-red-500 to-rose-500 text-white text-xs rounded hover:from-red-600 hover:to-rose-600 transition-all duration-300 shadow-sm",children:"Delete"})]})}),(0,n.jsx)("td",{className:"px-4 py-2 text-sm text-slate-700 border-b border-slate-200",children:e.timeSlot}),(0,n.jsx)("td",{className:"px-4 py-2 text-sm text-slate-700 border-b border-slate-200",children:e.performanceTypeName}),(0,n.jsxs)("td",{className:"px-4 py-2 text-sm text-slate-700 border-b border-slate-200",children:["\u20b9",e.pricePerPerson]}),(0,n.jsx)("td",{className:"px-4 py-2 text-sm text-slate-700 border-b border-slate-200",children:e.participantName}),(0,n.jsx)("td",{className:"px-4 py-2 text-sm text-slate-700 border-b border-slate-200",children:"duet"===e.performanceType?`${e.participant1Phone||""} / ${e.participant2Phone||""}`:e.phoneNumber||e.representativePhone||"-"}),(0,n.jsx)("td",{className:"px-4 py-2 text-sm text-slate-700 border-b border-slate-200",children:e.email||"-"}),(0,n.jsx)("td",{className:"px-4 py-2 text-sm text-slate-700 border-b border-slate-200",children:e.cityResidence||"-"}),(0,n.jsx)("td",{className:"px-4 py-2 text-sm text-slate-700 border-b border-slate-200",children:e.guruName||"-"}),(0,n.jsx)("td",{className:"px-4 py-2 text-sm text-slate-700 border-b border-slate-200",children:e.performanceCategory||"-"}),(0,n.jsxs)("td",{className:"px-4 py-2 text-sm text-slate-700 border-b border-slate-200",children:["\u20b9",e.amountPerSlot]}),(0,n.jsx)("td",{className:"px-4 py-2 text-sm text-slate-700 border-b border-slate-200",children:v(e.timestamp)}),(0,n.jsx)("td",{className:"px-4 py-2 text-sm text-slate-700 border-b border-slate-200",children:e.paymentId||"-"}),(0,n.jsx)("td",{className:"px-4 py-2 text-sm text-slate-700 border-b border-slate-200",children:e.paymentStatus||"-"}),(0,n.jsx)("td",{className:"px-4 py-2 text-sm text-slate-700 border-b border-slate-200",children:e.bookingId})]},e.id||t))})]})]}),(0,n.jsxs)("div",{className:"mt-8 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-200",children:[(0,n.jsx)("h4",{className:"font-medium text-blue-800 mb-2",children:"Admin Panel Instructions"}),(0,n.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1",children:[(0,n.jsxs)("li",{children:["\u2022 ",(0,n.jsx)("strong",{children:"View Bookings:"})," All bookings are displayed by default"]}),(0,n.jsxs)("li",{children:["\u2022 ",(0,n.jsx)("strong",{children:"Add Booking:"}),' Click "Add Booking" to manually add a new booking']}),(0,n.jsxs)("li",{children:["\u2022 ",(0,n.jsx)("strong",{children:"Edit Booking:"}),' Click "Edit" on any row to modify booking details']}),(0,n.jsxs)("li",{children:["\u2022 ",(0,n.jsx)("strong",{children:"Delete Booking:"}),' Click "Delete" to remove a booking (with confirmation)']}),(0,n.jsxs)("li",{children:["\u2022 ",(0,n.jsx)("strong",{children:"Export CSV:"})," Download all bookings as a CSV file"]}),(0,n.jsx)("li",{children:"\u2022 CSV files can be opened in Excel, Google Sheets, or any spreadsheet application"})]})]}),i&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Edit Booking"}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Booking ID"}),(0,n.jsx)("input",{type:"text",value:i.bookingId,onChange:e=>o({...i,bookingId:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Date"}),(0,n.jsx)("input",{type:"date",value:i.date,onChange:async e=>{const t=e.target.value;o({...i,date:t}),await j(t,i.timeSlot)},className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Time Slot"}),(0,n.jsxs)("select",{value:i.timeSlot,onChange:e=>o({...i,timeSlot:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,n.jsx)("option",{value:"",children:"Select a time slot"}),b.map(e=>(0,n.jsx)("option",{value:e,children:e},e))]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Performance Type"}),(0,n.jsx)("input",{type:"text",value:i.performanceTypeName,onChange:e=>o({...i,performanceTypeName:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),"duet"===i.performanceType?(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Participant 1 Phone"}),(0,n.jsx)("input",{type:"text",value:i.participant1Phone||"",onChange:e=>o({...i,participant1Phone:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Participant 2 Phone"}),(0,n.jsx)("input",{type:"text",value:i.participant2Phone||"",onChange:e=>o({...i,participant2Phone:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]})]}):"group"===i.performanceType?(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Representative Phone"}),(0,n.jsx)("input",{type:"text",value:i.representativePhone||"",onChange:e=>o({...i,representativePhone:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}):(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),(0,n.jsx)("input",{type:"text",value:i.phoneNumber||"",onChange:e=>o({...i,phoneNumber:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,n.jsx)("input",{type:"email",value:i.email||"",onChange:e=>o({...i,email:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"City"}),(0,n.jsx)("input",{type:"text",value:i.cityResidence||"",onChange:e=>o({...i,cityResidence:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Guru Name"}),(0,n.jsx)("input",{type:"text",value:i.guruName||"",onChange:e=>o({...i,guruName:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Performance Category"}),(0,n.jsx)("input",{type:"text",value:i.performanceCategory||"",onChange:e=>o({...i,performanceCategory:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Amount Per Slot"}),(0,n.jsx)("input",{type:"number",value:i.amountPerSlot,onChange:e=>o({...i,amountPerSlot:parseInt(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]})]}),(0,n.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,n.jsx)("button",{onClick:()=>o(null),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,n.jsx)("button",{onClick:()=>(async e=>{try{await(0,s.vq)(e),o(null),await y(),alert("Booking updated successfully")}catch(t){console.error("Update failed:",t),alert("Failed to update booking. Please try again.")}})(i),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Update"})]})]})}),c&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Add New Booking"}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Booking ID"}),(0,n.jsx)("input",{type:"text",value:m.bookingId||"",onChange:e=>p({...m,bookingId:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Date"}),(0,n.jsx)("input",{type:"date",value:m.date||"",onChange:async e=>{const t=e.target.value;p({...m,date:t,timeSlot:""}),await f(t)},className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Time Slot"}),(0,n.jsxs)("select",{value:m.timeSlot||"",onChange:e=>p({...m,timeSlot:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,n.jsx)("option",{value:"",children:"Select a time slot"}),u.map(e=>(0,n.jsx)("option",{value:e,children:e},e))]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Performance Type"}),(0,n.jsx)("input",{type:"text",value:m.performanceTypeName||"",onChange:e=>p({...m,performanceTypeName:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Full Name"}),(0,n.jsx)("input",{type:"text",value:m.fullName||"",onChange:e=>p({...m,fullName:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),(0,n.jsx)("input",{type:"text",value:m.phoneNumber||"",onChange:e=>p({...m,phoneNumber:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,n.jsx)("input",{type:"email",value:m.email||"",onChange:e=>p({...m,email:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"City"}),(0,n.jsx)("input",{type:"text",value:m.cityResidence||"",onChange:e=>p({...m,cityResidence:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Guru Name"}),(0,n.jsx)("input",{type:"text",value:m.guruName||"",onChange:e=>p({...m,guruName:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Performance Category"}),(0,n.jsx)("input",{type:"text",value:m.performanceCategory||"",onChange:e=>p({...m,performanceCategory:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Amount Per Slot"}),(0,n.jsx)("input",{type:"number",value:m.amountPerSlot||"",onChange:e=>p({...m,amountPerSlot:parseInt(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]})]}),(0,n.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,n.jsx)("button",{onClick:()=>{x(!1),p({})},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,n.jsx)("button",{onClick:async()=>{try{await(0,s.Bx)(m),x(!1),p({}),await y(),alert("Booking added successfully")}catch(e){console.error("Add failed:",e),alert("Failed to add booking. Please try again.")}},className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:"Add Booking"})]})]})})]})})}}}]);
//# sourceMappingURL=192.fac8e5e5.chunk.js.map