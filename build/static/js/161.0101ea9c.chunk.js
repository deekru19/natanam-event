"use strict";(self.webpackChunkdance_event_app=self.webpackChunkdance_event_app||[]).push([[161],{161:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var s=a(43),n=a(951),r=a(579);const i=e=>{let{selectedSlots:t,performanceType:a,participantDetails:i,onPaymentSuccess:c,onPaymentFailure:o,onBack:l}=e;const[d,m]=(0,s.useState)(!1),[p,u]=(0,s.useState)(""),x=n.J.performanceTypes.find(e=>e.id===a);if(!x)return(0,r.jsx)("div",{children:"Invalid performance type."});const h=(()=>{switch(a){case"solo":default:return 1;case"duet":return 2;case"group":const e=i.participantNames||"";if(e.trim()){const t=e.split(/[,\n]/).filter(e=>e.trim()).length;return Math.max(t,1)}return 3}})(),y=t.length*x.pricePerPerson*h,f=()=>{switch(a){case"solo":return i.fullName||"N/A";case"duet":return i.participant1Name||"N/A";case"group":const e=i.participantNames||"";if(e.trim()){return e.split(/[,\n]/).filter(e=>e.trim())[0]||"N/A"}return"N/A";default:return"N/A"}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Complete Payment"}),(0,r.jsx)("button",{onClick:l,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"\u2190 Back"})]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 space-y-4",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-700 mb-3",children:"Payment Summary"}),(0,r.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Performance Type:"}),(0,r.jsx)("span",{className:"font-medium",children:x.name})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Participant(s):"}),(0,r.jsx)("span",{className:"font-medium",children:h})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Time Slots:"}),(0,r.jsx)("span",{className:"font-medium",children:t.length})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Price per person per slot:"}),(0,r.jsxs)("span",{className:"font-medium",children:["\u20b9",x.pricePerPerson]})]}),(0,r.jsxs)("div",{className:"border-t pt-2 mt-3",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"font-medium text-gray-800",children:"Total Amount:"}),(0,r.jsxs)("span",{className:"text-xl font-bold text-gray-900",children:["\u20b9",y.toLocaleString()]})]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1 text-right",children:["\u20b9",x.pricePerPerson," \xd7 ",h," \xd7 ",t.length]})]})]})]}),(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,r.jsx)("h4",{className:"font-medium text-blue-800 mb-2",children:"Selected Time Slots"}),(0,r.jsx)("div",{className:"space-y-1",children:t.map((e,t)=>(0,r.jsxs)("p",{className:"text-sm text-blue-700",children:["\u2022 ",e]},t))})]}),(0,r.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,r.jsx)("h4",{className:"font-medium text-green-800 mb-2",children:"Secure Payment"}),(0,r.jsxs)("ul",{className:"text-sm text-green-700 space-y-1",children:[(0,r.jsx)("li",{children:"\u2022 Payment is processed securely through Razorpay"}),(0,r.jsx)("li",{children:"\u2022 You can pay using UPI, Cards, Net Banking, or Wallets"}),(0,r.jsx)("li",{children:"\u2022 Your booking will be confirmed instantly upon successful payment"}),(0,r.jsx)("li",{children:"\u2022 You will receive a confirmation email after payment"})]})]}),p&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,r.jsx)("p",{className:"text-sm text-red-600",children:p})}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{onClick:l,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",disabled:d,children:"Back"}),(0,r.jsx)("button",{onClick:async()=>{m(!0),u("");try{if(!await new Promise(e=>{const t=document.createElement("script");t.src="https://checkout.razorpay.com/v1/checkout.js",t.onload=()=>e(!0),t.onerror=()=>e(!1),document.body.appendChild(t)}))throw new Error("Failed to load Razorpay. Please check your internet connection.");const{phone:n,email:r}={phone:i.phoneNumber||i.participant1Phone||i.representativePhone||"",email:i.email||""};let l;try{const s=await fetch("/createRazorpayOrder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:100*y,currency:"INR",notes:{performance_type:a,time_slots:t.join(", "),participant_count:h.toString()}})});if(s.ok){var e;const t=await s.json();l=null===t||void 0===t||null===(e=t.order)||void 0===e?void 0:e.id}else console.warn("Order creation failed with status:",s.status)}catch(s){console.warn("Order creation failed, falling back to direct checkout:",s)}const d={key:"rzp_test_kqMZu5Fx9pDa9x",amount:100*y,currency:"INR",name:"Natanam Dance Event",description:`${x.name} Performance Registration`,image:"/logo192.png",...l?{order_id:l}:{},handler:function(e){console.log("Payment Success:",e),c({paymentId:e.razorpay_payment_id,orderId:e.razorpay_order_id,signature:e.razorpay_signature,amount:y,currency:"INR"})},prefill:{name:f(),email:r,contact:n},notes:{performance_type:a,time_slots:t.join(", "),participant_count:h.toString()},theme:{color:"#2563eb"},modal:{ondismiss:function(){m(!1)}}},p=new window.Razorpay(d);p.on("payment.failed",function(e){console.log("Payment Failed:",e),o({error:e.error,reason:e.error.reason,description:e.error.description})}),p.open(),m(!1)}catch(n){console.error("Payment initialization failed:",n),u(n.message||"Failed to initialize payment. Please try again."),m(!1)}},disabled:d,className:"px-8 py-3 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:d?"Processing...":`Pay \u20b9${y.toLocaleString()}`})]})]})}}}]);
//# sourceMappingURL=161.0101ea9c.chunk.js.map