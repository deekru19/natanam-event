"use strict";(self.webpackChunkdance_event_app=self.webpackChunkdance_event_app||[]).push([[275],{275:(e,t,s)=>{s.r(t),s.d(t,{default:()=>l});var r=s(43),n=s(951),a=s(638),i=s(579);const l=e=>{var t,s,l;let{selectedSlots:c,performanceType:o,participantDetails:d,onBack:m,onPaymentSuccess:p,onPaymentFailure:u}=e;const[x,h]=(0,r.useState)(!1),[f,y]=(0,r.useState)(""),j=n.J.performanceTypes.find(e=>e.id===o);if(!j)return(0,i.jsx)("div",{children:"Invalid performance type."});const g=(()=>{switch(o){case"solo":default:return 1;case"duet":return 2;case"group":const e=d.participantNames||"";if(e.trim()){const t=e.split(/[,\n]/).filter(e=>e.trim()).length;return Math.max(t,1)}return 3}})(),N=c.reduce((e,t)=>e+(0,a.ZP)(t,o)*g,0),b=()=>c.map(e=>({slot:e,price:(0,a.ZP)(e,o),tier:(0,a.FR)(e)})),w=()=>{switch(o){case"solo":return d.fullName||"N/A";case"duet":return d.participant1Name||"N/A";case"group":const e=d.participantNames||"";if(e.trim()){return e.split(/[,\n]/).filter(e=>e.trim())[0]||"N/A"}return"N/A";default:return"N/A"}};return(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsx)("div",{className:"flex items-center justify-between",children:(0,i.jsx)("div",{children:(0,i.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:"Payment Summary"})})}),(0,i.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 space-y-4",children:[(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Performance Details"}),(0,i.jsxs)("div",{className:"space-y-1 text-sm text-gray-600",children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("span",{className:"font-medium",children:"Type:"})," ",j.name]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("span",{className:"font-medium",children:"Participant(s):"})," ",(()=>{switch(o){case"solo":return d.fullName||"N/A";case"duet":return`${d.participant1Name||"N/A"} & ${d.participant2Name||"N/A"}`;case"group":const e=d.participantNames||"";if(e.trim()){const t=e.split(/[,\n]/).filter(e=>e.trim());return t.length>0?t.join(", "):"N/A"}return"N/A";default:return"N/A"}})()]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("span",{className:"font-medium",children:"Dance Style:"})," ",d.performanceCategory||"N/A"]})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Time Slots"}),(0,i.jsxs)("div",{className:"space-y-1 text-sm text-gray-600",children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("span",{className:"font-medium",children:"Selected:"})," ",c.length," slot",1!==c.length?"s":""]}),(0,i.jsx)("p",{children:(0,i.jsx)("span",{className:"font-medium",children:"Times:"})}),(0,i.jsx)("div",{className:"ml-4",children:null!==(t=n.J.timePricing)&&void 0!==t&&t.enabled?b().map((e,t)=>(0,i.jsxs)("p",{className:"text-gray-600 flex justify-between",children:[(0,i.jsxs)("span",{children:["\u2022 ",e.slot]}),(0,i.jsxs)("span",{className:"text-xs",children:[e.tier&&(0,a.C0)(e.tier)&&`${(0,a.C0)(e.tier)} - `,"\u20b9",e.price]})]},t)):c.map((e,t)=>(0,i.jsxs)("p",{className:"text-gray-600",children:["\u2022 ",e]},t))})]})]})]}),(0,i.jsx)("div",{className:"border-t pt-4",children:(0,i.jsxs)("div",{className:"space-y-2",children:[null!==(s=n.J.timePricing)&&void 0!==s&&s.enabled?(0,i.jsxs)("div",{className:"text-sm text-slate-600",children:[(0,i.jsx)("p",{className:"font-medium mb-2",children:"Pricing Breakdown:"}),b().map((e,t)=>(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsxs)("span",{children:[e.slot," \xd7 ",g," person",1!==g?"s":""]}),(0,i.jsxs)("span",{children:["\u20b9",(e.price*g).toLocaleString()]})]},t))]}):(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"flex justify-between items-center text-sm text-slate-600",children:[(0,i.jsx)("span",{children:"Price per person:"}),(0,i.jsxs)("span",{children:["\u20b9",j.pricePerPerson]})]})}),(0,i.jsxs)("div",{className:"flex justify-between items-center text-sm text-slate-600",children:[(0,i.jsx)("span",{children:"Number of participants:"}),(0,i.jsx)("span",{children:g})]}),(0,i.jsxs)("div",{className:"flex justify-between items-center text-sm text-slate-600",children:[(0,i.jsx)("span",{children:"Number of slots:"}),(0,i.jsx)("span",{children:c.length})]}),(0,i.jsxs)("div",{className:"border-t pt-2 mt-2",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center text-base font-medium",children:[(0,i.jsx)("span",{children:"Total Amount:"}),(0,i.jsxs)("span",{className:"text-slate-700",children:["\u20b9",N.toLocaleString()]})]}),!(null!==(l=n.J.timePricing)&&void 0!==l&&l.enabled)&&(0,i.jsxs)("p",{className:"text-xs text-slate-500 mt-1",children:["\u20b9",j.pricePerPerson," \xd7 ",g," person",1!==g?"s":""," \xd7 ",c.length," slot",1!==c.length?"s":""]})]})]})})]}),(0,i.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[(0,i.jsx)("h4",{className:"font-medium text-yellow-800 mb-2",children:"Payment Instructions"}),(0,i.jsxs)("ul",{className:"text-sm text-yellow-700 space-y-1",children:[(0,i.jsx)("li",{children:"\u2022 Please complete the payment using UPI or any preferred method"}),(0,i.jsxs)("li",{children:["\u2022 Amount to pay: \u20b9",N.toLocaleString()]}),(0,i.jsx)("li",{children:"\u2022 Your booking will be confirmed after payment verification"})]})]}),f&&(0,i.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,i.jsx)("p",{className:"text-sm text-red-600",children:f})}),(0,i.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[(0,i.jsx)("button",{onClick:m,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 shadow-sm w-full sm:w-auto",children:"\u2190 Back"}),(0,i.jsx)("button",{onClick:async()=>{h(!0),y("");try{var e;if(!await new Promise(e=>{const t=document.createElement("script");t.src="https://checkout.razorpay.com/v1/checkout.js",t.onload=()=>e(!0),t.onerror=()=>e(!1),document.body.appendChild(t)}))throw new Error("Failed to load Razorpay. Please check your internet connection.");const{phone:t,email:s}={phone:d.phoneNumber||d.participant1Phone||d.representativePhone||"",email:d.email||""},r="test-fe3f0";if(!r)throw new Error("Firebase Project ID not configured. Please check environment variables.");const a=`https://us-central1-${r}.cloudfunctions.net/createRazorpayOrder`;console.log("\ud83c\udf10 Creating order via Firebase Function:",a);const i=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:100*N,currency:"INR",notes:{performance_type:o,time_slots:c.join(", "),participant_count:g.toString()}})});if(!i.ok){const e=await i.text();throw new Error(`Order creation failed: ${i.status} - ${e}`)}const l=await i.json(),m=null===l||void 0===l||null===(e=l.order)||void 0===e?void 0:e.id;if(!m)throw new Error("Order created but no order ID returned from backend");console.log("\u2705 Order created successfully:",m);const x={key:"rzp_test_kqMZu5Fx9pDa9x",amount:100*N,currency:"INR",name:n.J.eventName,description:`${j.name} Performance Registration`,image:"/logo192.png",order_id:m,handler:function(e){console.log("\ud83c\udf89 Payment Success:",e),p({paymentId:e.razorpay_payment_id,orderId:e.razorpay_order_id,signature:e.razorpay_signature,amount:N,currency:"INR"})},prefill:{name:w(),email:s,contact:t},notes:{performance_type:o,time_slots:c.join(", "),participant_count:g.toString()},theme:{color:"#2563eb"},modal:{ondismiss:function(){h(!1)}}},f=new window.Razorpay(x);f.on("payment.failed",function(e){console.log("\u274c Payment Failed:",e),u({error:e.error,reason:e.error.reason,description:e.error.description})}),f.open(),h(!1)}catch(t){console.error("\ud83d\udca5 Payment initialization failed:",t),y(t.message||"Failed to initialize payment. Please try again."),h(!1)}},disabled:x,className:`\n            px-6 py-3 rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed w-full sm:w-auto\n            ${x?"bg-gray-400 text-white cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"}\n          `,children:x?"Processing...":`Pay \u20b9${N.toLocaleString()}`})]})]})}}}]);
//# sourceMappingURL=275.3ffffeb6.chunk.js.map