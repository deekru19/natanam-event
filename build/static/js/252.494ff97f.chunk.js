"use strict";(self.webpackChunkdance_event_app=self.webpackChunkdance_event_app||[]).push([[252],{252:(e,a,s)=>{s.r(a),s.d(a,{default:()=>i});var t=s(43),l=s(203),n=s(951),r=s(579);const i=e=>{var a;let{paymentData:s,selectedSlots:i,performanceType:d,participantDetails:c,onStatusConfirmed:o,onStatusFailed:m}=e;const[u,x]=(0,t.useState)(!0),[p,h]=(0,t.useState)(30),[f,y]=(0,t.useState)("checking");(0,t.useEffect)(()=>{if(null===s||void 0===s||!s.paymentId)return void m("Invalid payment data");const e=setInterval(()=>{h(a=>a<=1?(clearInterval(e),x(!1),m("Webhook timeout - payment status unclear"),0):a-1)},1e3),a=(0,l.QJ)(s.paymentId,(a,s)=>{if(console.log("Booking status update:",a,s),"confirmed"===a)clearInterval(e),y("confirmed"),x(!1),o();else if("cancelled"===a){var t;clearInterval(e),y("failed"),x(!1);const a=(null===s||void 0===s||null===(t=s.paymentData)||void 0===t?void 0:t.errorReason)||"Payment was declined or failed";m(a)}}),t=setInterval(async()=>{try{const r=await(0,l.Lh)(s.paymentId);if(console.log("Payment status check result:",r),"confirmed"===r.status)clearInterval(e),clearInterval(t),y("confirmed"),x(!1),o();else if("cancelled"===r.status){var a,n;clearInterval(e),clearInterval(t),y("failed"),x(!1);const s=(null===(a=r.booking)||void 0===a||null===(n=a.paymentData)||void 0===n?void 0:n.errorReason)||"Payment was declined or failed";m(s)}}catch(r){console.error("Error checking payment status:",r)}},3e3);return()=>{clearInterval(e),clearInterval(t),a()}},[null===s||void 0===s?void 0:s.paymentId,o,m]);const v=n.J.performanceTypes.find(e=>e.id===d);return u?(0,r.jsxs)("div",{className:"text-center space-y-6",children:[(0,r.jsx)("div",{className:"w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto",children:(0,r.jsx)("div",{className:"w-10 h-10 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Processing Payment..."}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"Please wait while we confirm your payment with our payment provider."}),(0,r.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4 inline-block",children:(0,r.jsxs)("p",{className:"text-sm text-blue-700",children:[(0,r.jsx)("span",{className:"font-medium",children:"Payment ID:"})," ",s.paymentId]})})]}),(0,r.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 max-w-md mx-auto",children:[(0,r.jsx)("p",{className:"text-sm text-yellow-700",children:(0,r.jsxs)("span",{className:"font-medium",children:["Timeout in ",p," seconds"]})}),(0,r.jsx)("p",{className:"text-xs text-yellow-600 mt-1",children:"We're waiting for payment confirmation from Razorpay"})]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 text-left max-w-md mx-auto",children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-800 mb-4 text-center",children:"Payment Details"}),(0,r.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Performance:"}),(0,r.jsx)("span",{className:"font-medium",children:null===v||void 0===v?void 0:v.name})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Time Slots:"}),(0,r.jsx)("span",{className:"font-medium",children:i.length})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Amount Paid:"}),(0,r.jsxs)("span",{className:"font-bold text-green-600",children:["\u20b9",null===(a=s.amount)||void 0===a?void 0:a.toLocaleString()]})]})]})]}),(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 max-w-md mx-auto",children:[(0,r.jsx)("h4",{className:"font-medium text-blue-800 mb-2",children:"What's happening?"}),(0,r.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1 text-left",children:[(0,r.jsx)("li",{children:"\u2022 Your payment has been submitted to Razorpay"}),(0,r.jsx)("li",{children:"\u2022 We're waiting for payment confirmation"}),(0,r.jsx)("li",{children:"\u2022 This usually takes 5-10 seconds"}),(0,r.jsx)("li",{children:"\u2022 Please don't close this page"})]})]})]}):null}}}]);
//# sourceMappingURL=252.494ff97f.chunk.js.map